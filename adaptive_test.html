<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>showAlert è‡ªé€‚åº”æµ‹è¯•</title>
    <!-- layui CSS -->
    <link rel="stylesheet" href="https://www.layuicdn.com/layui-v2.13.1/css/layui.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }

        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            max-width: 800px;
            margin: 0 auto;
        }

        .test-btn {
            background: #5B8DEF;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            margin: 4px;
            cursor: pointer;
            font-size: 13px;
            display: inline-block;
        }

        .test-btn:hover {
            background: #4A7CC7;
            transform: translateY(-1px);
        }

        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
        }

        .test-title {
            font-weight: bold;
            margin-bottom: 12px;
            color: #333;
            font-size: 16px;
        }

        .description {
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
            line-height: 1.5;
        }

        /* å³ä¸Šè§’æ‚¬æµ®Toastæ ·å¼ - çœŸæ­£è‡ªé€‚åº” */
        .alert-toast {
            position: fixed;
            top: 20px;
            right: -450px;
            width: fit-content; /* çœŸæ­£çš„è‡ªé€‚åº”å®½åº¦ */
            max-width: min(90vw, 400px); /* å“åº”å¼æœ€å¤§å®½åº¦ */
            min-width: fit-content; /* æœ€å°å®½åº¦ä¹Ÿç”±å†…å®¹å†³å®š */
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            backdrop-filter: blur(20px);
            border-radius: 0.75rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            z-index: 9999;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.875rem 1.125rem;
            transform: translateX(0);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            border: 1px solid rgba(255, 255, 255, 0.1);
            opacity: 0;
            font-size: 0.875rem;
            line-height: 1.4;
            white-space: nowrap;
            box-sizing: border-box;
            isolation: isolate;
        }

        .alert-toast.show {
            right: 20px;
            transform: translateX(0);
            opacity: 1;
        }

        .alert-toast.hide {
            right: -450px;
            transform: translateX(20px);
            opacity: 0;
        }

        .alert-toast.long-message {
            white-space: normal;
            width: fit-content;
            max-width: min(80vw, 500px);
        }

        .alert-toast .alert-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 24px;
            height: 24px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            flex-shrink: 0;
        }

        .alert-toast .alert-icon i {
            font-size: 14px !important;
            color: white;
            margin: 0;
            width: 14px;
            height: 14px;
            line-height: 14px;
        }

        .alert-toast .alert-message {
            flex: 1;
            color: white;
            font-weight: 500;
            word-break: break-word;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
        }

        .alert-toast .alert-close {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
            flex-shrink: 0;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: rgba(255, 255, 255, 0.8);
        }

        .alert-toast .alert-close:hover {
            background: rgba(255, 255, 255, 0.3);
            color: white;
            transform: scale(1.1);
        }

        .alert-toast .alert-close i {
            font-size: 12px !important;
            margin: 0;
            width: 12px;
            height: 12px;
            line-height: 12px;
        }

        /* ä¸åŒç±»å‹çš„èƒŒæ™¯è‰² */
        .alert-toast.alert-success {
            background: linear-gradient(135deg, #10B981, #059669);
        }

        .alert-toast.alert-error {
            background: linear-gradient(135deg, #EF4444, #DC2626);
        }

        .alert-toast.alert-warning {
            background: linear-gradient(135deg, #F59E0B, #D97706);
        }

        .alert-toast.alert-info {
            background: linear-gradient(135deg, #3B82F6, #1E40AF);
        }

        .alert-toast.alert-autosave {
            background: linear-gradient(135deg, #6366F1, #4F46E5);
        }

        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 480px) {
            .alert-toast {
                top: 10px;
                right: -350px;
                width: fit-content;
                max-width: calc(100vw - 40px);
                padding: 0.75rem 1rem;
                font-size: 0.8rem;
                gap: 0.5rem;
            }

            .alert-toast.show {
                right: 10px;
            }

            .alert-toast.hide {
                right: -350px;
            }

            .alert-toast.long-message {
                width: fit-content;
                max-width: calc(100vw - 30px);
                white-space: normal;
            }
        }

        .width-display {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            z-index: 9998;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ¯ showAlert çœŸæ­£è‡ªé€‚åº”æµ‹è¯•</h1>
        <p class="description">
            è¿™ä¸ªæµ‹è¯•é¡µé¢éªŒè¯ alert å®¹å™¨æ˜¯å¦èƒ½æ ¹æ®å†…å®¹è‡ªåŠ¨è°ƒæ•´å®½åº¦ï¼Œä¸å†å‡ºç°çŸ­æ¶ˆæ¯æ˜¾ç¤ºè¿‡é•¿å®¹å™¨çš„é—®é¢˜ã€‚
        </p>

        <div class="test-section">
            <div class="test-title">ğŸ“ å®½åº¦è‡ªé€‚åº”æµ‹è¯•</div>
            <p class="description">æµ‹è¯•ä¸åŒé•¿åº¦æ¶ˆæ¯çš„è‡ªé€‚åº”æ•ˆæœ</p>

            <button class="test-btn" onclick="showAlert('success', 'âœ“')">1å­—ç¬¦</button>
            <button class="test-btn" onclick="showAlert('info', 'âœ“ æˆåŠŸ')">3å­—ç¬¦</button>
            <button class="test-btn" onclick="showAlert('warning', 'æ“ä½œæˆåŠŸå®Œæˆï¼')">7å­—ç¬¦</button>
            <button class="test-btn" onclick="showAlert('error', 'è¿™æ˜¯ä¸€æ¡ä¸­ç­‰é•¿åº¦çš„æ¶ˆæ¯')">12å­—ç¬¦</button>
            <button class="test-btn" onclick="showAlert('success', 'è¿™æ˜¯ä¸€æ¡è¾ƒé•¿çš„æ¶ˆæ¯ç”¨æ¥æµ‹è¯•è‡ªé€‚åº”')">19å­—ç¬¦</button>
            <button class="test-btn" onclick="showAlert('info', 'è¿™æ˜¯ä¸€æ¡å¾ˆé•¿çš„æ¶ˆæ¯ç”¨æ¥æµ‹è¯•è‡ªé€‚åº”å®½åº¦æ˜¯å¦çœŸçš„æœ‰æ•ˆ')">30å­—ç¬¦</button>
        </div>

        <div class="test-section">
            <div class="test-title">ğŸ”¤ ä¸­è‹±æ–‡æ··åˆæµ‹è¯•</div>
            <p class="description">æµ‹è¯•ä¸­è‹±æ–‡æ··åˆå†…å®¹çš„è‡ªé€‚åº”æ•ˆæœ</p>

            <button class="test-btn" onclick="showAlert('success', 'OK')">2å­—ç¬¦</button>
            <button class="test-btn" onclick="showAlert('info', 'Save')">4å­—ç¬¦</button>
            <button class="test-btn" onclick="showAlert('warning', 'Config Saved')">13å­—ç¬¦</button>
            <button class="test-btn" onclick="showAlert('error', 'Configuration file has been updated successfully')">47å­—ç¬¦</button>
        </div>

        <div class="test-section">
            <div class="test-title">ğŸ¨ ä¸åŒç±»å‹æ¶ˆæ¯æµ‹è¯•</div>
            <p class="description">æµ‹è¯•ä¸åŒç±»å‹æ¶ˆæ¯çš„æ˜¾ç¤ºæ•ˆæœ</p>

            <button class="test-btn" onclick="showAlert('success', 'æ“ä½œæˆåŠŸ')">æˆåŠŸ</button>
            <button class="test-btn" onclick="showAlert('error', 'å‘ç”Ÿé”™è¯¯')">é”™è¯¯</button>
            <button class="test-btn" onclick="showAlert('warning', 'è¯·æ³¨æ„')">è­¦å‘Š</button>
            <button class="test-btn" onclick="showAlert('info', 'ä¿¡æ¯æç¤º')">ä¿¡æ¯</button>
            <button class="test-btn" onclick="showAlert('autosave', 'è‡ªåŠ¨ä¿å­˜å®Œæˆ')">è‡ªåŠ¨ä¿å­˜</button>
        </div>

        <div class="test-section">
            <div class="test-title">ğŸš€ è¿ç»­æ˜¾ç¤ºæµ‹è¯•</div>
            <p class="description">è¿ç»­æ˜¾ç¤ºä¸åŒé•¿åº¦çš„æ¶ˆæ¯ï¼Œè§‚å¯Ÿå®½åº¦å˜åŒ–</p>

            <button class="test-btn" onclick="testSequential()">è¿ç»­æ˜¾ç¤º</button>
            <button class="test-btn" onclick="clearAllAlerts()">æ¸…é™¤æ‰€æœ‰</button>
        </div>

        <div class="test-section">
            <div class="test-title">ğŸ“ å®½åº¦ä¿¡æ¯</div>
            <p class="description">æ˜¾ç¤ºå½“å‰é¡µé¢ä¸Šæ‰€æœ‰ alert çš„å®é™…å®½åº¦ä¿¡æ¯ï¼ˆæŸ¥çœ‹å·¦ä¸‹è§’ï¼‰</p>
            <button class="test-btn" onclick="toggleWidthDisplay()">åˆ‡æ¢å®½åº¦æ˜¾ç¤º</button>
        </div>
    </div>

    <div id="widthDisplay" class="width-display" style="display: none;">
        <div>Alert å®½åº¦ç›‘æ§</div>
    </div>

    <!-- layui JS -->
    <script src="https://www.layuicdn.com/layui-v2.13.1/layui.js"></script>
    <script>
        // å®Œå…¨è‡ªé€‚åº”çš„ showAlert å‡½æ•°
        function showAlert(type, message) {
            console.log('showAlertè¢«è°ƒç”¨:', type, message);
            const alertId = 'alert-' + Date.now();

            // åˆ›å»ºalertå®¹å™¨å’Œå†…å®¹
            const alertContainer = document.createElement('div');
            alertContainer.id = alertId;
            alertContainer.className = `alert-toast alert-${type}`;

            // æ ¹æ®æ¶ˆæ¯é•¿åº¦å†³å®šæ˜¯å¦éœ€è¦æ¢è¡Œ
            if (message.length > 30) {
                alertContainer.classList.add('long-message');
            }

            // æ ¹æ®ç±»å‹é€‰æ‹©å›¾æ ‡å’Œè‡ªåŠ¨éšè—æ—¶é—´
            let iconClass = '';
            let autoHide = 3000;
            switch(type) {
                case 'success':
                    iconClass = 'layui-icon-ok-circle';
                    autoHide = 3000;
                    break;
                case 'error':
                    iconClass = 'layui-icon-close';
                    autoHide = 5000;
                    break;
                case 'warning':
                    iconClass = 'layui-icon-warning';
                    autoHide = 4000;
                    break;
                case 'info':
                    iconClass = 'layui-icon-about';
                    autoHide = 3000;
                    break;
                case 'autosave':
                    iconClass = 'layui-icon-refresh';
                    autoHide = 2000;
                    break;
                default:
                    iconClass = 'layui-icon-about';
                    autoHide = 3000;
            }

            alertContainer.innerHTML = `
                <div class="alert-icon">
                    <i class="layui-icon ${iconClass}"></i>
                </div>
                <div class="alert-message">
                    <span>${message}</span>
                </div>
                <div class="alert-close" onclick="this.parentElement.remove()">
                    <i class="layui-icon layui-icon-close"></i>
                </div>
            `;

            // æ·»åŠ åˆ°é¡µé¢å³ä¸Šè§’
            document.body.appendChild(alertContainer);

            // è·å–å®é™…å®½åº¦ç”¨äºè°ƒè¯•
            const actualWidth = alertContainer.offsetWidth;
            console.log(`Alert "${message}" å®é™…å®½åº¦: ${actualWidth}px`);

            // æ›´æ–°å®½åº¦æ˜¾ç¤º
            updateWidthDisplay();

            // è§¦å‘è¿›å…¥åŠ¨ç”»
            setTimeout(() => {
                alertContainer.classList.add('show');
            }, 50);

            // è‡ªåŠ¨éšè—
            const hideTimeout = setTimeout(() => {
                alertContainer.classList.add('hide');
                setTimeout(() => {
                    if (document.getElementById(alertId)) {
                        alertContainer.remove();
                        updateWidthDisplay();
                    }
                }, 400);
            }, autoHide);

            // é¼ æ ‡æ‚¬åœæ—¶å–æ¶ˆè‡ªåŠ¨éšè—
            alertContainer.addEventListener('mouseenter', () => {
                clearTimeout(hideTimeout);
            });

            alertContainer.addEventListener('mouseleave', () => {
                setTimeout(() => {
                    alertContainer.classList.add('hide');
                    setTimeout(() => {
                        if (document.getElementById(alertId)) {
                            alertContainer.remove();
                            updateWidthDisplay();
                        }
                    }, 400);
                }, 1000);
            });

            return alertContainer;
        }

        function testSequential() {
            const messages = [
                { type: 'success', text: 'âœ“' },
                { type: 'info', text: 'âœ“ æˆåŠŸ' },
                { type: 'warning', text: 'æ“ä½œæˆåŠŸå®Œæˆï¼' },
                { type: 'error', text: 'è¿™æ˜¯ä¸€æ¡ä¸­ç­‰é•¿åº¦çš„æ¶ˆæ¯' },
                { type: 'success', text: 'è¿™æ˜¯ä¸€æ¡è¾ƒé•¿çš„æ¶ˆæ¯ç”¨æ¥æµ‹è¯•è‡ªé€‚åº”' },
                { type: 'info', text: 'è¿™æ˜¯ä¸€æ¡å¾ˆé•¿çš„æ¶ˆæ¯ç”¨æ¥æµ‹è¯•è‡ªé€‚åº”å®½åº¦æ˜¯å¦çœŸçš„æœ‰æ•ˆ' }
            ];

            messages.forEach((msg, index) => {
                setTimeout(() => {
                    showAlert(msg.type, msg.text);
                }, index * 1500);
            });
        }

        function clearAllAlerts() {
            const alerts = document.querySelectorAll('.alert-toast');
            alerts.forEach(alert => alert.remove());
            updateWidthDisplay();
        }

        function toggleWidthDisplay() {
            const display = document.getElementById('widthDisplay');
            display.style.display = display.style.display === 'none' ? 'block' : 'none';
            updateWidthDisplay();
        }

        function updateWidthDisplay() {
            const display = document.getElementById('widthDisplay');
            if (display.style.display === 'none') return;

            const alerts = document.querySelectorAll('.alert-toast.show');
            let content = '<div>ğŸ“ Alert å®½åº¦ç›‘æ§</div>';

            if (alerts.length === 0) {
                content += '<div>æ²¡æœ‰æ˜¾ç¤ºçš„ alert</div>';
            } else {
                alerts.forEach((alert, index) => {
                    const width = alert.offsetWidth;
                    const message = alert.querySelector('.alert-message span').textContent;
                    content += `<div>Alert ${index + 1}: ${width}px | "${message}"</div>`;
                });
            }

            display.innerHTML = content;
        }

        // é¡µé¢åŠ è½½å®Œæˆåæ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                showAlert('success', 'ğŸ¯ showAlert è‡ªé€‚åº”æµ‹è¯•é¡µé¢å·²åŠ è½½ï¼ç°åœ¨å®¹å™¨ä¼šæ ¹æ®å†…å®¹è‡ªåŠ¨è°ƒæ•´å®½åº¦ã€‚');
            }, 500);
        });

        // å®šæœŸæ›´æ–°å®½åº¦æ˜¾ç¤º
        setInterval(updateWidthDisplay, 1000);
    </script>
</body>
</html>