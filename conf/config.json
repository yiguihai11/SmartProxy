{
  "listener": {
    "socks5_port": 1080,
    "web_port": 8080,
    "dns_port": 1053,
    "ipv6_enabled": true
  },
  "socks5": {
    "max_connections": 1000,
    "cleanup_interval": 300,
    "enable_auth": true,
    "auth_users": [
      {
        "username": "admin",
        "password": "admin123",
        "enabled": true,
        "user_groups": [
          "admin"
        ],
        "rate_limit": {
          "upload_bps": 10485760,
          "download_bps": 10485760,
          "burst_size": 52428800
        },
        "connection_limit": {
          "max_connections": 10,
          "expires_after_minutes": 1440,
          "allow_from_ips": [
            "127.0.0.1",
            "::1",
            "192.168.0.0/16"
          ],
          "block_from_ips": [
            "10.0.0.1"
          ],
          "time_restriction": {
            "allowed_hours": [
              "09:00-18:00"
            ],
            "allowed_days": [
              "monday-friday"
            ],
            "timezone": "Asia/Shanghai"
          }
        }
      }
    ]
  },
  "router": {
    "chnroutes": {
      "enable": true,
      "path": "conf/chnroutes.txt"
    },
    "rules": [
      {
        "action": "block",
        "patterns": [
          "*.facebook.com",
          "*.fbcdn.net",
          "1.2.3.4",
          "1.2.3.0/24",
          "2001:db8::/32",
          "2001:4860::/32",
          "2607:f8b0::/32",
          "2001:db8::/32",
          "2001:4860::/32",
          "2001:db8::/32"
        ],
        "description": "阻止访问恶意域名和IP（包含IPv6网段）"
      },
      {
        "action": "proxy",
        "patterns": [
          "*.twitter.com",
          "x.com",
          "api.twitter.com"
        ],
        "proxy_node": "proxy1",
        "description": "Twitter/X相关域名通过proxy1代理"
      },
      {
        "action": "allow",
        "patterns": [
          "*.cn",
          "*.com.cn",
          "*.net.cn",
          "*.org.cn",
          "*.gov.cn",
          "*.edu.cn",
          "*.ac.cn"
        ],
        "description": "中国域名直连"
      },
      {
        "action": "allow",
        "patterns": [
          "192.168.0.0/16",
          "10.0.0.0/8",
          "172.16.0.0/12",
          "127.0.0.1",
          "::1",
          "fc00::/7",
          "fe80::/10",
          "::ffff:0:0/96"
        ],
        "description": "私有网络和本地回环直连（包含IPv6私有地址）"
      },
      {
        "action": "deny",
        "patterns": [
          "25",
          "587",
          "110",
          "143",
          "993",
          "995"
        ],
        "description": "邮件和代理服务端口走代理"
      },
      {
        "action": "proxy",
        "patterns": [
          "*.gmail.com",
          "*.google.com",
          "outlook.com",
          "*.office365.com",
          "*.yahoo.com",
          "*.qq.com",
          "*.163.com",
          "*.126.com"
        ],
        "proxy_node": "proxy3",
        "description": "邮件服务通过proxy3代理"
      },
      {
        "action": "allow",
        "patterns": [
          "8081",
          "8082",
          "8888",
          "9000",
          "9001",
          "3000",
          "5000",
          "6379"
        ],
        "description": "开发和服务端口示例（可直连）"
      },
      {
        "action": "proxy",
        "patterns": [
          "3389",
          "5432",
          "3306",
          "1433",
          "22"
        ],
        "proxy_node": "proxy2",
        "description": "远程管理和数据库端口通过proxy2代理"
      }
    ],
    "proxy_nodes": null
  },
  "traffic_detection": {
    "enabled": true,
    "enhanced_probing": {
      "enable": true,
      "sni_extraction": true,
      "http_validation": true,
      "max_initial_data_size": 4096,
      "validation_timeout_ms": 1500,
      "probing_ports": [
        80,
        443,
        8080,
        8443
      ]
    }
  },
  "dns": {
    "enabled": true,
    "cache": {
      "max_size": 2000,
      "default_ttl": 300,
      "cleanup_interval": 60
    },
    "groups": {
      "cn": [
        "223.5.5.5:53",
        "119.29.29.29:53"
      ],
      "foreign": [
        "8.8.8.8:53",
        "1.1.1.1:53"
      ]
    },
    "hijack_rules": [
      {
        "pattern": "api.dev.local",
        "target": "127.0.0.1:8080",
        "description": "本地API服务"
      },
      {
        "pattern": "dev.database",
        "target": "192.168.1.50:3306",
        "description": "开发数据库服务器"
      },
      {
        "pattern": "*.test.staging",
        "target": "127.0.0.1:3000",
        "description": "测试环境本地化"
      },
      {
        "pattern": "redis.cache.local",
        "target": "127.0.0.1:6379",
        "description": "Redis缓存服务"
      },
      {
        "pattern": "mongodb.local",
        "target": "127.0.0.1:27017",
        "description": "MongoDB数据库"
      },
      {
        "pattern": "debug.proxy",
        "target": "127.0.0.1:1080",
        "description": "调试代理服务器"
      },
      {
        "pattern": "*.internal.msvc",
        "target": "[2001:db8::/32]:443",
        "description": "内部微服务集群"
      },
      {
        "pattern": "gateway.ipv6.lan",
        "target": "[fe80::1]:8080",
        "description": "IPv6网关服务"
      },
      {
        "pattern": "docker.ipv6.registry",
        "target": "[fd00::1]:5000",
        "description": "IPv6 Docker镜像仓库"
      },
      {
        "pattern": "ads.example.com",
        "target": "0.0.0.0",
        "description": "广告域名劫持到空地址(屏蔽)"
      },
      {
        "pattern": "tracker.malicious.com",
        "target": "127.0.0.1",
        "description": "恶意跟踪域名劫持到本地"
      }
    ]
  },
  "connection_settings": {
    "tcp_timeout_seconds": 60,
    "udp_timeout_seconds": 300
  },
  "logging": {
    "level": "info",
    "enable_user_logs": true,
    "enable_access_logs": true,
    "log_file": "proxy.log"
  }
}